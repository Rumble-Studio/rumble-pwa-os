<div class="tasks-list-container">
	<mat-form-field appearance="outline">
		<mat-label>Filter</mat-label>
		<input
			matInput
			(keyup)="applyFilter($event)"
			#input />
	</mat-form-field>

	<table
		#table
		mat-table
		*ngIf="dataSource.data.length; else noDataTpl"
		[dataSource]="dataSource"
		matSort>
		<ng-container matColumnDef="id">
			<th
				mat-header-cell
				*matHeaderCellDef
				mat-sort-header>
				ID
			</th>
			<td
				mat-cell
				*matCellDef="let element">
				{{ element.id.substring(0, 5) }}
			</td>
		</ng-container>

		<ng-container matColumnDef="timeCreation">
			<th
				mat-header-cell
				*matHeaderCellDef
				mat-sort-header>
				Creation time
			</th>
			<td
				mat-cell
				*matCellDef="let element">
				{{ element.timeCreation > 0 ? (element.timeCreation * 1000 | date: 'yy/MM/dd, HH:mm') : 'âˆž' }}
			</td>
		</ng-container>

		<ng-container matColumnDef="name">
			<th
				mat-header-cell
				*matHeaderCellDef
				mat-sort-header>
				Name
			</th>
			<td
				mat-cell
				*matCellDef="let element">
				<!-- {{ element.name }} -->
				<rumble-pwa-group-item-generic [groupId]="element.id"></rumble-pwa-group-item-generic>
			</td>
		</ng-container>

		<ng-container matColumnDef="description">
			<th
				mat-header-cell
				*matHeaderCellDef
				mat-sort-header>
				Description
			</th>
			<td
				mat-cell
				*matCellDef="let element">
				{{ element.description }}
			</td>
		</ng-container>

		<ng-container matColumnDef="kind">
			<th
				mat-header-cell
				*matHeaderCellDef
				mat-sort-header>
				Kind
			</th>
			<td
				mat-cell
				*matCellDef="let element">
				{{ element.kind }}
			</td>
		</ng-container>
		<ng-container matColumnDef="children">
			<th
				mat-header-cell
				*matHeaderCellDef
				mat-sort-header>
				Children
			</th>
			<td
				mat-cell
				*matCellDef="let element">
				<mat-chip-list>
					<mat-chip
						class="mat-chip-list-stacked"
						*ngFor="let childId of element.childIds"
						(click)="openGroupModal(childId, false, element.id)">
						<rumble-pwa-group-item-generic [groupId]="childId"></rumble-pwa-group-item-generic>
					</mat-chip>
					<mat-chip>
						<mat-icon (click)="addChild(element)">add</mat-icon>
					</mat-chip>
				</mat-chip-list>
			</td>
		</ng-container>

		<ng-container matColumnDef="parents">
			<th
				mat-header-cell
				*matHeaderCellDef
				mat-sort-header>
				Parents
			</th>
			<td
				mat-cell
				*matCellDef="let element">
				<mat-chip-list>
					<mat-chip
						class="mat-chip-list-stacked"
						*ngFor="let parentId of element.parentIds"
						(click)="openGroupModal(parentId, true, element.id)">
						<rumble-pwa-group-item-generic [groupId]="parentId"></rumble-pwa-group-item-generic>
					</mat-chip>
					<mat-chip>
						<mat-icon (click)="addParent(element)">add</mat-icon>
					</mat-chip>
				</mat-chip-list>
			</td>
		</ng-container>

		<ng-container matColumnDef="grants">
			<th
				mat-header-cell
				*matHeaderCellDef>
				Grants
			</th>
			<td
				mat-cell
				*matCellDef="let element">
				<mat-chip-list>
					<mat-chip
						class="mat-chip-list-stacked"
						*ngFor="let grant of element.grants"
						(click)="openGrantModal(grant)">
						{{ grant.permissionId }}
					</mat-chip>
				</mat-chip-list>
			</td>
		</ng-container>

		<tr
			mat-header-row
			*matHeaderRowDef="displayedColumns"></tr>
		<tr
			mat-row
			*matRowDef="let row; columns: displayedColumns; let element"></tr>

		<tr
			class="mat-row"
			*matNoDataRow>
			<td
				class="mat-cell"
				colspan="4">
				No data matching the filter "{{ input.value }}"
			</td>
		</tr>
	</table>

	<mat-paginator
		[pageSizeOptions]="[100, 250, 1000]"
		aria-label="Select page of users"
		[pageSize]="100"></mat-paginator>
</div>
<ng-template #noDataTpl>
	<span class="no-data">No group available</span>
</ng-template>
